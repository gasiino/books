"fossum" <-
structure(list(case = c(2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 17, 
19, 20, 21, 23, 27, 29, 30, 32, 37, 39, 40, 41, 43, 50, 51, 53, 
57, 60, 62, 63, 64, 65, 66, 70, 74, 82, 83, 86, 88, 99, 102, 
104), site = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 
6, 6, 7, 7, 7, 7), Pop = structure(as.integer(c(1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 
2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2)), .Label = c("Vic", 
"other"), class = "factor"), sex = structure(as.integer(c(1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
)), .Label = c("f", "m"), class = "factor"), age = c(6, 6, 6, 
2, 1, 6, 9, 6, 9, 5, 1, 5, 4, 3, 4, 2, 3, 2, 4, 2, 1, 3, 5, 2, 
5, 5, 3, 4, 2, 3, 6, 3, 5, 3, 7, 4, 4, 3, 3, 2, 3, 6, 3), hdlngth = c(92.5, 
94, 93.2, 91.5, 93.1, 94.8, 93.4, 91.8, 93.3, 94.9, 94.7, 94.4, 
94.8, 95.9, 92.5, 90.5, 92.8, 92.1, 94.3, 89.3, 84.7, 91, 88.4, 
90, 91.6, 95.6, 93.1, 95.1, 91.3, 91.3, 92, 96.9, 93.5, 90.4, 
91.9, 88.7, 86, 90, 88.2, 89.6, 93.3, 92.4, 93.6), skullw = c(57.6, 
60, 57.1, 56.3, 54.8, 57.6, 56.3, 58, 57.2, 55.6, 67.7, 55.4, 
56.3, 58.1, 56.1, 54.5, 56, 54.4, 56.7, 54.8, 51.5, 55, 57, 55.5, 
56.4, 59.6, 58.1, 59.4, 57.7, 58, 56.4, 56.5, 57.4, 55.8, 56.4, 
52, 54, 53.8, 53.2, 58, 56.2, 55, 59.9), totlngth = c(91.5, 95.5, 
92, 85.5, 90.5, 91, 91.5, 89.5, 89.5, 92, 89.5, 90.5, 89, 96.5, 
89, 85, 88, 84, 94, 82.5, 75, 84.5, 83, 81, 88, 85, 91, 93, 88, 
90.5, 88.5, 89.5, 88.5, 86, 87, 83, 82, 81.5, 86.5, 87.5, 86.5, 
89, 89), taill = c(36.5, 39, 38, 36, 35.5, 37, 37, 37.5, 39, 
35.5, 36.5, 35, 38, 39.5, 36, 35, 35, 33.5, 39, 35, 34, 36, 36.5, 
32, 38, 36, 38, 41, 39, 39, 38, 38.5, 38, 36.5, 38, 38, 36.5, 
36, 38.5, 38, 38.5, 38, 40), pes = c(72.5, 75.4, 76.1, 71, 73.2, 
72.7, 72.4, 70.9, 77.2, 71.7, 73.2, 73.4, 73.8, 77.9, 72.8, 70.3, 
74.9, 70.6, 74.8, 71.2, 68.7, 72.8, NA, 72, 65, 64, 67.4, 67.2, 
63.1, 65.5, 64.1, 63, 68.2, 63.2, 65.4, 61.5, 60.7, 62, 60.3, 
66.7, 64.8, 63.5, 67.6), earconch = c(51.2, 51.9, 52.2, 53.2, 
53.6, 53.9, 52.9, 53.4, 51.3, 51, 53.2, 53.9, 52.4, 52.9, 53.3, 
50.8, 51.8, 50.8, 52, 52, 53.4, 51.4, 40.3, 49.4, 47.2, 43.9, 
46, 45.3, 47, 41.3, 46.3, 45.1, 41.7, 44.2, 44.1, 45.9, 42.9, 
43.3, 43.7, 43.5, 43.8, 45.4, 46), eye = c(16, 15.5, 15.2, 15.1, 
14.2, 14.5, 15.5, 14.4, 14.9, 15.3, 14.7, 15.2, 15.5, 14.2, 15.4, 
14.2, 14, 14.5, 14.9, 13.6, 13, 13.6, 15.9, 13.4, 14.9, 17.4, 
16.5, 14.5, 14.4, 16, 15.2, 17.1, 14, 15.7, 13, 14.7, 15.4, 14, 
13.6, 16, 14, 13, 14.8), chest = c(28.5, 30, 28, 28.5, 30, 29, 
28, 27.5, 31, 28, 29, 28, 27, 30, 28, 23, 24, 24.5, 28, 28, 25, 
27, 27, 29, 28, 28, 26, 31, 26, 27, 25.5, 25.5, 29, 26.5, 27, 
26, 26, 25, 26, 25.5, 28, 25, 28.5), belly = c(33, 34, 34, 33, 
32, 34, 33, 32, 34, 33, 31, 32, 36, 40, 35, 28, 32, 33, 34, 31.5, 
25, 30, 30.5, 31, 36, 38.5, 33.5, 39, 30, 32, 28.5, 33, 38.5, 
34, 34, 34, 32, 29, 31, 31.5, 35, 30, 33.5)), .Names = c("case", 
"site", "Pop", "sex", "age", "hdlngth", "skullw", "totlngth", 
"taill", "pes", "earconch", "eye", "chest", "belly"), row.names = c("C5", 
"C10", "C15", "C23", "C24", "C27", "C28", "C31", "C32", "C34", 
"C45", "C48", "C50", "C54", "C58", "C63", "A1", "A2", "A4", "BB17", 
"BB31", "BB33", "BB36", "BB40", "WW4", "WW5", "WW7", "BR4", "BR7", 
"CD2", "CD3", "CD4", "CD5", "CD6", "CD10", "BSF1", "BSF9", "BSF10", 
"BSF13", "BTP3", "BTP15", "BTP19", "BTP21"), class = "data.frame")
"res" <-
function (ls.object) 
{
a <- ls.object$a
b <- ls.object$b
x <- ls.object$data[,1]
y <- ls.object$data[,2]
resids <- y - a - b*x
resids
}
"ls.est" <-
function (data) 
{x <- data[,1]
 y <- data[,2]
 Sxy <- S(x,y)
 Sxx <- S(x,x)
 b <- Sxy/Sxx
 a <- mean(y) - mean(x)*b
list(a = a, b = b, data=data)
}
"roller2.plot" <-
function(y = roller$depression, x = roller$weight, a = 2, b=2)
{
   titl <- paste("Lawn depression (mm) versus roller weight (t).", sep = "")
    yhat <- a + b*x
    ymax <- max(c(y, yhat))+40
    plot(x, y, xlab = "Roller weight (t)", ylab =
            "Depression in lawn (mm)", pch = 4, xlim=c(0, max(x)),
            ylim=c(0, ymax),col=4)
#    title(titl)
pause()
abline(a,b)
pause()
   points(x, yhat, pch = 16, col=3)
pause()
    topleft <- par()$usr[c(1, 4)]
    chw <- par()$cxy[1]
    chh <- par()$cxy[2]

    legend(topleft[1], topleft[2]+0.25*chh,pch=c(16,4),col=c(3,4),
        legend=c("Fitted values", "Data values"),     
       adj=0,cex=0.8, x.intersp=0.8, y.intersp=0.8, bty="n")
    here <- y > yhat
    z <- as.vector(rbind(y[here], yhat[here], rep(NA, sum(here))))
    zx <- as.vector(rbind(x[here], x[here], x[here]))
 
    lines(zx, z, lwd=2, col=2)
pause()
    here <- y < yhat    
  z <- as.vector(rbind(y[here], yhat[here], rep(NA, sum(here))))
    zx <- as.vector(rbind(x[here], x[here], x[here]))
 

    n <- length(y)
    ns <- min((1:n)[y - yhat >= 0.75*max(y - yhat)])
    ypos <- 0.5 * (y[ns] + yhat[ns])
    chw <- par()$cxy[1]
    text(x[ns] - 0.25*chw, ypos, "+ve residual", adj = 1,cex=0.8)
 pause()
   lines(zx, z, lty = 1, lwd=2, col=6)
    ns <- (1:n)[y - yhat == min(y - yhat)][1]  
   ypos <- 0.5 * (y[ns] + yhat[ns])
    text(x[ns] + 0.4*chw, ypos, "-ve residual", adj = 0,cex=0.8)
  }
"roller3.plot" <-
function(y = roller$depression, x = roller$weight, a = 2, b=2)
{
   titl <- paste("Squared Residuals", sep = "")
    yhat <- a + b*x
    ymax <- max(c(y, yhat))+100
    plot(x, y, xlab = "Roller weight (t)", ylab =
            "Depression in lawn (mm)", pch = 4, xlim=c(0, max(x)),
            ylim=c(0, ymax),col=4)
#    title(titl)
pause()
abline(a,b)
pause()
   points(x, yhat, pch = 16, col=3)
pause()

    options(digits=3)

    topleft <- par()$usr[c(1, 4)]
    chw <- par()$cxy[1]
    chh <- par()$cxy[2]

    legend(topleft[1], topleft[2]+0.25*chh,pch=c(16,4),col=c(3,4),
        legend=c("Fitted values", "Data values"),     
       adj=0,cex=0.8, x.intersp=0.8, y.intersp=0.8, bty="n")
   here <- y > yhat
    z <- as.vector(rbind((y[here]-yhat[here])^2+yhat[here], yhat[here], rep(NA, sum(here))))
    zx <- as.vector(rbind(x[here], x[here], x[here]))
 
    lines(zx, z, lwd=2, col=2)
pause()
    here <- y < yhat    
  z <- as.vector(rbind((y[here]-yhat[here])^2+yhat[here], yhat[here], rep(NA, sum(here))))
    zx <- as.vector(rbind(x[here], x[here], x[here]))
 

    n <- length(y)
    ns <- min((1:n)[y - yhat >= 0.75*max(y - yhat)])
    ypos <- 0.5 * (y[ns] + yhat[ns])
    chw <- par()$cxy[1]
    text(x[ns] - 0.25*chw, ypos, "+ve residual", adj = 1,cex=0.8)
 pause()
   lines(zx, z, lty = 1, lwd=2, col=6)
    ns <- (1:n)[y - yhat == min(y - yhat)][1]  
   ypos <- 0.5 * (y[ns] + yhat[ns])
    text(x[ns] + 0.4*chw, ypos, "-ve residual", adj = 0,cex=0.8)
  }
"S" <-
function (x,y) 
{
sum((x-mean(x))*(y-mean(y)))
}
"simple.sim" <-
function(intercept=0,slope=1,x=seq(1,10),sigma=1){
noise <- rnorm(length(x),sd = sigma)
y <- intercept + slope*x + noise
title1 <- paste("intercept = ",intercept, ", slope = ", slope, ", sigma = ", sigma)
plot(x,y,pch=16,main=title1)
abline(intercept,slope,col=4,lwd=2)
}
