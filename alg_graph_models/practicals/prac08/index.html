<?xml version="1.0"  encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <link rel="stylesheet" type="text/css" href="../../teaching.css" />
      <title>AGM Practical 08</title>
  </head>
  <body>
    <h1>Algorithms for Graphical Models (AGM)</h1>
    <h2>Practical 08: Machine learning</h2>

    <hr />
    
    <ol>
      <li>
	<a href="#compress">Data compression</a>
      </li>
      <li>
	<a href="#scoring">Scoring BNs</a>
      </li>
      <li>
	<a href="#searching">Searching for good BNs</a>
      </li>
    </ol>
    <hr />
    
    <h4><a id="compress"></a>Data compression</h4>

    <p>
      Have a look at <a
      href="make_data.py"><tt>make_data.py</tt></a>. It reads in the
      ever-present Asia example, and generates data from it using
      forward sampling, saving the data to a file whose name is
      supplied on the command line. Run it to create some data.
    </p>

    <p>
      This is a bulky representation since multiple occurrences of a
      given instantiation are written out in full each time. Alter
      <tt>make_data.py</tt> to make a new program called
      <tt>make_data2.py</tt>. This new program should produce output
      where each instantiation is written out once together with a
      count of how many times it was sampled. See <a
	href="data.txt">data.txt</a> for an example of the desired output.
    </p>

    <p>
      <a href="make_data2.py">Solution</a>
    </p>

    <hr />

    <h4><a id="scoring"></a>Scoring BNs</h4>

    <p>
      Have a look at <a
      href="score_asia.py"><tt>score_asia.py</tt></a>. Run it by
      supplying a CSV data file as a command line argument. (Use <a
      href="data.txt"><tt>data.txt</tt></a> if you like.) Note that it
      uses a <tt>BN</tt> method called <tt>bdeu_score</tt> to score
      an entire BN, and also <tt>CPT</tt> method of the same name to
      score individual `families' (variable + its parents). The BDeu
      score is just the marginal log-likelihood with a choice of
      Dirichlet prior parameters which ensures likelihood equivalence.
    </p>

    <p>
      Add to <a
      href="score_asia.py"><tt>score_asia.py</tt></a> so that you get
      the score for the BNM model whose ADG is like that of Asia
      except that the arrow from <tt>Smoking</tt> to <tt>Cancer</tt>
      is missing.</p>

    <p>
      <a href="score_asia_sol.py">Solution</a>
    </p>

    <hr />

    <h4><a id="searching"></a>Searching for good BNs</h4>

 
    <p>
      Write a program which finds the highest scoring ADG (Bayesian
      network model) for <a href="data.txt">data.txt</a>. Use BDeu
      scoring, and take advantage of the fact that this score is a sum
      of variable-specific scores. To make your life easier only
      consider:</p>
    <ol>
      <li>BNs consistent with the following topological ordering:
      <tt>Smoking,Cancer,Bronchitis,VisitAsia,Tuberculosis,TbOrCa,XRay,Dyspnea</tt>. For
      a BN to be consistent with this ordering a variable's parents
      have to come before it in the ordering.
      </li> 
      <li>
	BNs where no variable has more than three parents.
      </li>
    </ol>
    <p>
      You will find it useful to cannibalise bits of the previous programs.
    </p>


    <p>
      <a href="bn_search.py">Solution</a>
    </p>


    <hr />
    <p>
<!-- hhmts start -->
Last modified: Fri Dec  7 09:31:41 GMT 2007
<!-- hhmts end -->
    </p>
    
    <p>
      <a href="http://validator.w3.org/check?uri=referer"><img
          src="../../valid-xhtml11"
          alt="Valid XHTML 1.1!" height="31" width="88" /></a>
    </p>

</body>
</html>